# 交互式光学实验室 - 产品开发方案 (v0.3)

**最终目标:** 开发一个功能强大、物理精确、界面美观、交互流畅、易于使用的跨平台光学仿真工具，特别侧重于原子分子光物理(AMO)和量子精密测量等现代光学实验的模拟，适用于教育教学、科研初步验证、光学设计演示等场景。

**核心原则:**

* 追求完美、注重细节
* 用户体验优先
* 物理准确性与性能平衡
* 分阶段迭代开发
* **专业界面对标:** 借鉴成熟CAD/CAE软件的界面布局和交互逻辑，提升专业感和操作效率。

**开发阶段划分:**

**第一阶段：核心功能完善与体验优化 (已基本完成)**

* **目标:** 巩固核心功能，修复问题，优化交互体验。
* **任务列表:**
    * **[已完成]** 基本元件库（光源、镜、片、屏、块、缝、栅、偏振、波片、AOM、光纤、探测器等）。
    * **[已完成]** 核心物理模拟（反射、折射、色散、衍射基础、偏振基础、干涉基础）。
    * **[已完成]** 完整的操作历史与撤销/重做 (Undo/Redo) 功能。
    * **[已完成]** 元件单选/多选、移动、旋转、删除。
    * **[已完成]** 专业的UI框架（顶部菜单栏、右侧带标签页的检查器面板）。
    * **[已完成]** 画布缩放、平移。
    * **[已完成]** 场景本地保存/加载/管理。
    * **[已完成]** 模式切换（光线追踪 vs 透镜成像）。
    * **[已完成]** 全局设置面板（网格、光线数、弹射数、强度阈值等）。
    * **[待办]** **对齐辅助线与元件吸附:** 拖动元件时，显示与其他元件对齐的参考线并自动吸附。
    * **[待办]** **元件成组 (Grouping):** 将多个元件组合成一个整体进行操作。
    * **[待办]** **浅色主题选项:** 开发并允许用户切换到更接近标准CAD软件的浅色界面主题。
    * **[待办]** **用户系统与云同步:** 实现用户登录注册及云端场景存取功能（后端开发）。

**第二阶段：AMO与量子光学元件库扩展 (当前焦点)**

* **目标:** 丰富元件库，使其能支持搭建典型的AMO和量子精密测量实验光路，并全面提升元件的视觉真实感。
* **任务列表:**
    * **[待办]** **元件视觉设计全面升级:**
        * **目标:** 使每个元件在工具栏和画布上的渲染更贴近真实的实验室器件。
        * **示例:**
            * **偏振分束器 (PBS):** 绘制成一个立方体（正方形），中间带有一条45度对角线，并标明反射/透射端口。
            * **反射镜 (Mirror):** 为背面添加更明确的斜线填充。
            * **透镜 (Lens):** 根据焦距正负，更清晰地绘制为双凸或双凹形状。
            * **波片 (Wave Plate):** 在元件上清晰标注快轴方向和类型 (λ/2, λ/4)。
        * **实现:** 重点修改各元件在 `components.js` 中的 `draw(ctx)` 方法和在 `index.html` 中的工具栏SVG图标。

    * **[待办]** **新增元件：法拉第隔离器 (Faraday Isolator)**
        * **应用:** 激光注入锁定、防止有害光反馈。
        * **视觉设计:** 一个带有表示光线允许单向通过箭头的矩形框。
        * **物理功能 (`interact`):** 允许光线从输入端完美通过。对于从输出端反向入射的光线，则完全吸收或将其偏转出光路（终止光线）。

    * **[待办]** **新增元件：电光调制器 (EOM - Electro-Optic Modulator)**
        * **应用:** 激光稳频 (PDH技术)、高速光开关。
        * **视觉设计:** 一个晶体状的矩形，带有射频(RF)输入符号。
        * **物理功能 (`interact`):** 当光线通过时，为其附加一个相位调制。在简化的模型中，可以表现为将单色光分裂成载波和两个边带（三条频率略有差异的光线）。这需要 `Ray` 类支持频率属性或通过波长微小变化来模拟。

    * **[待-办]** **新增元件：原子蒸汽池 (Atomic Vapor Cell)**
        * **应用:** 饱和吸收光谱、原子钟、磁力计。
        * **视觉设计:** 一个玻璃材质感的圆柱体或立方体池，内部可有微弱的颜色示意。
        * **物理功能 (`interact`):** 具有强烈的波长依赖性吸收特性。当入射光波长接近原子共振频率时，光线强度急剧衰减（被吸收）。可以为其设定一个中心波长和吸收线宽。

    * **[待办]** **新增元件：法布里-珀罗标准具 (Fabry-Pérot Etalon/Cavity)**
        * **应用:** 激光稳频、光谱分析、激光器谐振腔。
        * **视觉设计:** 由两片平行放置、具有高反射率的反射镜组成。
        * **物理功能 (`interact`):** 这是一个多光束干涉元件。当光线入射时，会在两镜之间多次反射和透射。只有当光波长满足谐振条件（腔长是半波长的整数倍）时，透射率才接近1，否则透射率极低。这需要一个能处理多次内部反射的复杂 `interact` 方法。

**第三阶段：物理模型深化**

* **目标:** 提高模拟的物理精度，完善现有物理效应。
* **任务列表:**
    * **[待办]** **高斯光束完善:** 精确追踪光束宽度和曲率半径，实现ABCD矩阵变换。
    * **[待办]** **衍射与干涉模型增强:** 实现基于惠更斯原理或傅里叶光学的衍射计算，在屏幕上显示更真实的衍射图样。
    * **[待办]** **偏振模型深化:** 实现菲涅尔方程，模拟布儒斯特角等现象。
    * **[待办]** **透镜像差模拟:** 加入球差、彗差等具体模型。

**第四阶段：高级功能与产品化**

* **目标:** 实现云同步、协作、导出等高级功能，将其包装成完整的应用。
* **任务列表:**
    * **[待办]** **后端开发与云同步**
    * **[待办]** **单位与标尺系统**
    * **[待办]** **结果导出 (图像/数据)**
    * **[待办]** **性能优化 (Web Workers, WebGL)**
    * **[待办]** **跨平台打包 (Electron/Tauri)**